<!DOCTYPE html>
<html lang="ru">
<head>
<meta charset="UTF-8">
<title>IP Lookup</title>
<link rel="stylesheet" href="style.css">
<style>
  body { font-family: Arial; background: #111; color: #0f0; padding: 40px; }
  input, button { padding: 10px; font-size: 16px; }
  button { cursor: pointer; }
  pre { background: #000; padding: 15px; margin-top: 20px; color: #0f0; }
</style>
</head>
<body>

    <h2>Test -></h2>
    <button id="APIClicked">click to Get your API ADRESS</button>
    <h1 class="Api" id="APIAdressSpan"></h1>

<h1>IP Lookup</h1>

<input id="ipInput" placeholder="Например: 8.8.8.8">
<button onclick="lookup()">Найти</button>

<pre id="result"></pre>

<script>
    const BtnUserGetApi = document.getElementById("APIClicked");
const SpanApi = document.getElementById("APIAdressSpan")

let ToggleClickedButton = false;

BtnUserGetApi.addEventListener("click", () => {
    if (ToggleClickedButton) return;

    ToggleClickedButton = true;
    GetApi();

    setTimeout(() => {
        ToggleClickedButton = false;
    }, 5000);
});

function GetApi() {
    fetch('https://api.ipify.org?format=json')
        .then(response => response.json())
        .then(data => {
            SpanApi.innerHTML = `your api adress is (${data.ip})`
        })
        .catch(error => {
            console.error('Ошибка получения IP:', error);
        });
}

async function lookup() {
  const ip = document.getElementById("ipInput").value;
  const result = document.getElementById("result");
  result.textContent = "Загрузка...";

  try {
    const res = await fetch("/lookup-ip", {
      method: "POST",
      headers: { "Content-Type": "application/json" },
      body: JSON.stringify({ ip })
    });
    const data = await res.json();
    result.textContent = JSON.stringify(data, null, 2);
  } catch (e) {
    result.textContent = "Ошибка запроса";
  }
}
</script>

</body>
</html>